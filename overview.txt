#----------------------------------------------------------------------------

0_trim_filter_raw_reads.sh

#!/bin/bash
#SBATCH --nodes=1
#SBATCH --ntasks-per-node=1
#SBATCH --cpus-per-task=1
#SBATCH --time=5:00:00
#SBATCH --mem=2GB
#SBATCH --job-name=bbduk_chip
#SBATCH --mail-type=END
#SBATCH --mail-user=pf887@nyu.edu
#SBATCH --output=slurm_%j.out
 
module purge

module load bbmap/38.42
module load fastqc/0.11.8
module load multiqc/intel/1.7
#module load pigz/intel/2.3.4


#SAMPLES
bbduk.sh -Xmx1g in=HGVGWAFX2_n01_S2new.fastq.gz out=chip_sample_2_clean.fastq ref=/scratch/wa23/chip_2020/2020-08-27_HGVGWAFX2/merged/adapters.fa ktrim=r k=11 mink=11 hdist=1 tpe tbo qtrim=rl trimq=10
bbduk.sh -Xmx1g in=HGVGWAFX2_n01_S3new.fastq.gz out=chip_sample_3_clean.fastq ref=/scratch/wa23/chip_2020/2020-08-27_HGVGWAFX2/merged/adapters.fa ktrim=r k=11 mink=11 hdist=1 tpe tbo qtrim=rl trimq=10
bbduk.sh -Xmx1g in=HGVGWAFX2_n01_S4new.fastq.gz out=chip_sample_4_clean.fastq ref=/scratch/wa23/chip_2020/2020-08-27_HGVGWAFX2/merged/adapters.fa ktrim=r k=11 mink=11 hdist=1 tpe tbo qtrim=rl trimq=10

#SAMPLES
bbduk.sh -Xmx1g in=HGVGWAFX2_n01_I2new.fastq.gz out=chip_input_2_clean.fastq ref=/scratch/wa23/chip_2020/2020-08-27_HGVGWAFX2/merged/adapters.fa ktrim=r k=11 mink=11 hdist=1 tpe tbo qtrim=rl trimq=10
bbduk.sh -Xmx1g in=HGVGWAFX2_n01_I3new.fastq.gz out=chip_input_3_clean.fastq ref=/scratch/wa23/chip_2020/2020-08-27_HGVGWAFX2/merged/adapters.fa ktrim=r k=11 mink=11 hdist=1 tpe tbo qtrim=rl trimq=10
bbduk.sh -Xmx1g in=HGVGWAFX2_n01_I4new.fastq.gz out=chip_input_4_clean.fastq ref=/scratch/wa23/chip_2020/2020-08-27_HGVGWAFX2/merged/adapters.fa ktrim=r k=11 mink=11 hdist=1 tpe tbo qtrim=rl trimq=10

fastqc *clean*
multiqc .

#-----------------------------------------


To map the reads to bowtie used “1_runbowtie_new.sh”

#!/bin/bash

#BATCH --verbose
#SBATCH --job-name=bowtie_raw
#SBATCH --time=5:00:00
#SBATCH --nodes=1
#SBATCH --tasks-per-node=1
#SBATCH --cpus-per-task=20
#SBATCH --mem=40GB
#SBATCH --mail-type=ALL

module purge

module load bowtie2/intel/2.3.2
module load perl/intel/5.24.0

cp /genomics/genomes/Public/Invertebrate/Caenorhabditis_elegans/Ensembl/WBcel235/Caenorhabditis_elegans.WBcel235.dna.toplevel* .

np=$SLURM_CPUS_PER_TASK

bowtie2 -p $np -x /scratch/pf887/chipseq/NewChIPData/porfirio/2020-08-27_HGVGWAFX2/merged/Caenorhabditis_elegans.WBcel235.dna.toplevel -U /scratch/pf887/chipseq/NewChIPData/porfirio/2020-08-27_HGVGWAFX2/merged/chip_sample_2_clean.fastq -S /scratch/pf887/chipseq/NewChIPData/porfirio/2020-08-27_HGVGWAFX2/merged/chip_sample_2_clean.sam 
bowtie2 -p $np -x /scratch/pf887/chipseq/NewChIPData/porfirio/2020-08-27_HGVGWAFX2/merged/Caenorhabditis_elegans.WBcel235.dna.toplevel -U /scratch/pf887/chipseq/NewChIPData/porfirio/2020-08-27_HGVGWAFX2/merged/chip_sample_3_clean.fastq -S /scratch/pf887/chipseq/NewChIPData/porfirio/2020-08-27_HGVGWAFX2/merged/chip_sample_3_clean.sam 
bowtie2 -p $np -x /scratch/pf887/chipseq/NewChIPData/porfirio/2020-08-27_HGVGWAFX2/merged/Caenorhabditis_elegans.WBcel235.dna.toplevel -U /scratch/pf887/chipseq/NewChIPData/porfirio/2020-08-27_HGVGWAFX2/merged/chip_sample_4_clean.fastq -S /scratch/pf887/chipseq/NewChIPData/porfirio/2020-08-27_HGVGWAFX2/merged/chip_sample_4_clean.sam 
bowtie2 -p $np -x /scratch/pf887/chipseq/NewChIPData/porfirio/2020-08-27_HGVGWAFX2/merged/Caenorhabditis_elegans.WBcel235.dna.toplevel -U /scratch/pf887/chipseq/NewChIPData/porfirio/2020-08-27_HGVGWAFX2/merged/chip_input_2_clean.fastq -S /scratch/pf887/chipseq/NewChIPData/porfirio/2020-08-27_HGVGWAFX2/merged/chip_input_2_clean.sam 
bowtie2 -p $np -x /scratch/pf887/chipseq/NewChIPData/porfirio/2020-08-27_HGVGWAFX2/merged/Caenorhabditis_elegans.WBcel235.dna.toplevel -U /scratch/pf887/chipseq/NewChIPData/porfirio/2020-08-27_HGVGWAFX2/merged/chip_input_3_clean.fastq -S /scratch/pf887/chipseq/NewChIPData/porfirio/2020-08-27_HGVGWAFX2/merged/chip_input_3_clean.sam 
bowtie2 -p $np -x /scratch/pf887/chipseq/NewChIPData/porfirio/2020-08-27_HGVGWAFX2/merged/Caenorhabditis_elegans.WBcel235.dna.toplevel -U /scratch/pf887/chipseq/NewChIPData/porfirio/2020-08-27_HGVGWAFX2/merged/chip_input_4_clean.fastq -S /scratch/pf887/chipseq/NewChIPData/porfirio/2020-08-27_HGVGWAFX2/merged/chip_input_4_clean.sam 

module load samtools/intel/1.9
samtools view -bS chip_input_2_clean.sam > chip_input_2_clean.bam
samtools view -bS chip_input_3_clean.sam > chip_input_3_clean.bam
samtools view -bS chip_input_4_clean.sam > chip_input_4_clean.bam
samtools view -bS chip_sample_2_clean.sam > chip_sample_2_clean.bam
samtools view -bS chip_sample_3_clean.sam > chip_sample_3_clean.bam
samtools view -bS chip_sample_4_clean.sam > chip_sample_4_clean.bam

#--------------------------------------------

Used macs to remove duplicates. “2_macs2_filtedup.sh”
!/bin/bash

#BATCH --verbose
#SBATCH --job-name=rvm_dups_1
#SBATCH --time=30:00
#SBATCH --nodes=1
#SBATCH --mem=20GB
#SBATCH --mail-type=ALL


#Time
start=$(date +"%T")
echo "begin remove duplicates: $start"

module purge
module load bedtools/intel/2.27.1
module load samtools/intel/1.6
module load macs2/intel/2.1.1

#Remove all duplicates that appear more then expected. Can modify duplicate number easily by
#adding in the --keep-dup parameter to another number i.e. --keep-dup=5
#run this command in the BAM folder

macs2 filterdup -f BAM -i /scratch/pf887/chipseq/NewChIPData/porfirio/2020-08-27_HGVGWAFX2/merged/BAM/chip_sample_2_clean.bam -o /scratch/pf887/chipseq/NewChIPData/porfirio/2020-08-27_HGVGWAFX2/merged/BAM/BAMs_w_rvm_duplicates/chip_sample_2_clean_dupsrm.bed
macs2 filterdup -f BAM -i /scratch/pf887/chipseq/NewChIPData/porfirio/2020-08-27_HGVGWAFX2/merged/BAM/chip_input_2_clean.bam -o /scratch/pf887/chipseq/NewChIPData/porfirio/2020-08-27_HGVGWAFX2/merged/BAM/BAMs_w_rvm_duplicates/chip_input_2_clean_dupsrm.bed
macs2 filterdup -f BAM -i /scratch/pf887/chipseq/NewChIPData/porfirio/2020-08-27_HGVGWAFX2/merged/BAM/chip_sample_3_clean.bam -o /scratch/pf887/chipseq/NewChIPData/porfirio/2020-08-27_HGVGWAFX2/merged/BAM/BAMs_w_rvm_duplicates/chip_sample_3_clean_dupsrm.bed
macs2 filterdup -f BAM -i /scratch/pf887/chipseq/NewChIPData/porfirio/2020-08-27_HGVGWAFX2/merged/BAM/chip_input_3_clean.bam -o /scratch/pf887/chipseq/NewChIPData/porfirio/2020-08-27_HGVGWAFX2/merged/BAM/BAMs_w_rvm_duplicates/chip_input_3_clean_dupsrm.bed
macs2 filterdup -f BAM -i /scratch/pf887/chipseq/NewChIPData/porfirio/2020-08-27_HGVGWAFX2/merged/BAM/chip_sample_4_clean.bam -o /scratch/pf887/chipseq/NewChIPData/porfirio/2020-08-27_HGVGWAFX2/merged/BAM/BAMs_w_rvm_duplicates/chip_sample_4_clean_dupsrm.bed
macs2 filterdup -f BAM -i /scratch/pf887/chipseq/NewChIPData/porfirio/2020-08-27_HGVGWAFX2/merged/BAM/chip_input_4_clean.bam -o /scratch/pf887/chipseq/NewChIPData/porfirio/2020-08-27_HGVGWAFX2/merged/BAM/BAMs_w_rvm_duplicates/chip_input_4_clean_dupsrm.bed

echo "filterdup done" 

#-------------------------------------

Then sorted and indexed the file. “3_sort_index_fullpath.sh”
#!/bin/bash

#BATCH --verbose
#SBATCH --job-name=rvm_dups_1
#SBATCH --time=15:00:00
#SBATCH --nodes=1
#SBATCH --mem=20GB
#SBATCH --mail-type=ALL


#Time
start=$(date +"%T")
echo "begin sort: $start"

module purge
module load bedtools/intel/2.27.1
module load samtools/intel/1.6
module load macs2/intel/2.1.1



#next i will use samtools sort 
#printf "Sorting $bamfile\n"

samtools sort -o /scratch/pf887/chipseq/NewChIPData/porfirio/2020-08-27_HGVGWAFX2/merged/BAM/BAMs_w_rvm_duplicates/chip_sample_2_clean_dupsrm_sorted.bam /scratch/pf887/chipseq/NewChIPData/porfirio/2020-08-27_HGVGWAFX2/merged/BAM/BAMs_w_rvm_duplicates/chip_sample_2_clean_dupsrm.bam
samtools sort -o /scratch/pf887/chipseq/NewChIPData/porfirio/2020-08-27_HGVGWAFX2/merged/BAM/BAMs_w_rvm_duplicates/chip_input_2_clean_dupsrm_sorted.bam /scratch/pf887/chipseq/NewChIPData/porfirio/2020-08-27_HGVGWAFX2/merged/BAM/BAMs_w_rvm_duplicates/chip_input_2_clean_dupsrm.bam
samtools sort -o /scratch/pf887/chipseq/NewChIPData/porfirio/2020-08-27_HGVGWAFX2/merged/BAM/BAMs_w_rvm_duplicates/chip_sample_3_clean_dupsrm_sorted.bam /scratch/pf887/chipseq/NewChIPData/porfirio/2020-08-27_HGVGWAFX2/merged/BAM/BAMs_w_rvm_duplicates/chip_sample_3_clean_dupsrm.bam
samtools sort -o /scratch/pf887/chipseq/NewChIPData/porfirio/2020-08-27_HGVGWAFX2/merged/BAM/BAMs_w_rvm_duplicates/chip_input_3_clean_dupsrm_sorted.bam /scratch/pf887/chipseq/NewChIPData/porfirio/2020-08-27_HGVGWAFX2/merged/BAM/BAMs_w_rvm_duplicates/chip_input_3_clean_dupsrm.bam
samtools sort -o /scratch/pf887/chipseq/NewChIPData/porfirio/2020-08-27_HGVGWAFX2/merged/BAM/BAMs_w_rvm_duplicates/chip_sample_4_clean_dupsrm_sorted.bam /scratch/pf887/chipseq/NewChIPData/porfirio/2020-08-27_HGVGWAFX2/merged/BAM/BAMs_w_rvm_duplicates/chip_sample_4_clean_dupsrm.bam
samtools sort -o /scratch/pf887/chipseq/NewChIPData/porfirio/2020-08-27_HGVGWAFX2/merged/BAM/BAMs_w_rvm_duplicates/chip_input_4_clean_dupsrm_sorted.bam /scratch/pf887/chipseq/NewChIPData/porfirio/2020-08-27_HGVGWAFX2/merged/BAM/BAMs_w_rvm_duplicates/chip_input_4_clean_dupsrm.bam

echo "done sorting bam"
echo "begin copying sorted bams"

cp /scratch/pf887/chipseq/NewChIPData/porfirio/2020-08-27_HGVGWAFX2/merged/BAM/BAMs_w_rvm_duplicates/chip_sample_2_clean_dupsrm_sorted.bam /scratch/pf887/chipseq/NewChIPData/porfirio/2020-08-27_HGVGWAFX2/merged/BAM/BAMs_w_rvm_duplicates/chip_sample_2_clean_dupsrm_sort.bam
cp /scratch/pf887/chipseq/NewChIPData/porfirio/2020-08-27_HGVGWAFX2/merged/BAM/BAMs_w_rvm_duplicates/chip_input_2_clean_dupsrm_sorted.bam /scratch/pf887/chipseq/NewChIPData/porfirio/2020-08-27_HGVGWAFX2/merged/BAM/BAMs_w_rvm_duplicates/chip_input_2_clean_dupsrm_sort.bam
cp /scratch/pf887/chipseq/NewChIPData/porfirio/2020-08-27_HGVGWAFX2/merged/BAM/BAMs_w_rvm_duplicates/chip_sample_3_clean_dupsrm_sorted.bam /scratch/pf887/chipseq/NewChIPData/porfirio/2020-08-27_HGVGWAFX2/merged/BAM/BAMs_w_rvm_duplicates/chip_sample_3_clean_dupsrm_sort.bam
cp /scratch/pf887/chipseq/NewChIPData/porfirio/2020-08-27_HGVGWAFX2/merged/BAM/BAMs_w_rvm_duplicates/chip_input_3_clean_dupsrm_sorted.bam /scratch/pf887/chipseq/NewChIPData/porfirio/2020-08-27_HGVGWAFX2/merged/BAM/BAMs_w_rvm_duplicates/chip_input_3_clean_dupsrm_sort.bam
cp /scratch/pf887/chipseq/NewChIPData/porfirio/2020-08-27_HGVGWAFX2/merged/BAM/BAMs_w_rvm_duplicates/chip_sample_4_clean_dupsrm_sorted.bam /scratch/pf887/chipseq/NewChIPData/porfirio/2020-08-27_HGVGWAFX2/merged/BAM/BAMs_w_rvm_duplicates/chip_sample_4_clean_dupsrm_sort.bam
cp /scratch/pf887/chipseq/NewChIPData/porfirio/2020-08-27_HGVGWAFX2/merged/BAM/BAMs_w_rvm_duplicates/chip_input_4_clean_dupsrm_sorted.bam /scratch/pf887/chipseq/NewChIPData/porfirio/2020-08-27_HGVGWAFX2/merged/BAM/BAMs_w_rvm_duplicates/chip_input_4_clean_dupsrm_sort.bam

echo "done copying sorted bams new name is sort"
echo "using mv to replace the sorted files, new name indexed"

mv /scratch/pf887/chipseq/NewChIPData/porfirio/2020-08-27_HGVGWAFX2/merged/BAM/BAMs_w_rvm_duplicates/chip_sample_2_clean_dupsrm_sorted.bam /scratch/pf887/chipseq/NewChIPData/porfirio/2020-08-27_HGVGWAFX2/merged/BAM/BAMs_w_rvm_duplicates/chip_sample_2_clean_dupsrm_sorted_indexed.bam
mv /scratch/pf887/chipseq/NewChIPData/porfirio/2020-08-27_HGVGWAFX2/merged/BAM/BAMs_w_rvm_duplicates/chip_input_2_clean_dupsrm_sorted.bam /scratch/pf887/chipseq/NewChIPData/porfirio/2020-08-27_HGVGWAFX2/merged/BAM/BAMs_w_rvm_duplicates/chip_input_2_clean_dupsrm_sorted_indexed.bam
mv /scratch/pf887/chipseq/NewChIPData/porfirio/2020-08-27_HGVGWAFX2/merged/BAM/BAMs_w_rvm_duplicates/chip_sample_3_clean_dupsrm_sorted.bam /scratch/pf887/chipseq/NewChIPData/porfirio/2020-08-27_HGVGWAFX2/merged/BAM/BAMs_w_rvm_duplicates/chip_sample_3_clean_dupsrm_sorted_indexed.bam
mv /scratch/pf887/chipseq/NewChIPData/porfirio/2020-08-27_HGVGWAFX2/merged/BAM/BAMs_w_rvm_duplicates/chip_input_3_clean_dupsrm_sorted.bam /scratch/pf887/chipseq/NewChIPData/porfirio/2020-08-27_HGVGWAFX2/merged/BAM/BAMs_w_rvm_duplicates/chip_input_3_clean_dupsrm_sorted_indexed.bam
mv /scratch/pf887/chipseq/NewChIPData/porfirio/2020-08-27_HGVGWAFX2/merged/BAM/BAMs_w_rvm_duplicates/chip_sample_4_clean_dupsrm_sorted.bam /scratch/pf887/chipseq/NewChIPData/porfirio/2020-08-27_HGVGWAFX2/merged/BAM/BAMs_w_rvm_duplicates/chip_sample_4_clean_dupsrm_sorted_indexed.bam
mv /scratch/pf887/chipseq/NewChIPData/porfirio/2020-08-27_HGVGWAFX2/merged/BAM/BAMs_w_rvm_duplicates/chip_input_4_clean_dupsrm_sorted.bam /scratch/pf887/chipseq/NewChIPData/porfirio/2020-08-27_HGVGWAFX2/merged/BAM/BAMs_w_rvm_duplicates/chip_input_4_clean_dupsrm_sorted_indexed.bam

echo "starting actual indexing of index files"
#next i will index the bams

samtools index /scratch/pf887/chipseq/NewChIPData/porfirio/2020-08-27_HGVGWAFX2/merged/BAM/BAMs_w_rvm_duplicates/chip_sample_2_clean_dupsrm_sorted_indexed.bam
samtools index /scratch/pf887/chipseq/NewChIPData/porfirio/2020-08-27_HGVGWAFX2/merged/BAM/BAMs_w_rvm_duplicates/chip_input_2_clean_dupsrm_sorted_indexed.bam
samtools index /scratch/pf887/chipseq/NewChIPData/porfirio/2020-08-27_HGVGWAFX2/merged/BAM/BAMs_w_rvm_duplicates/chip_sample_3_clean_dupsrm_sorted_indexed.bam
samtools index /scratch/pf887/chipseq/NewChIPData/porfirio/2020-08-27_HGVGWAFX2/merged/BAM/BAMs_w_rvm_duplicates/chip_input_3_clean_dupsrm_sorted_indexed.bam
samtools index /scratch/pf887/chipseq/NewChIPData/porfirio/2020-08-27_HGVGWAFX2/merged/BAM/BAMs_w_rvm_duplicates/chip_sample_4_clean_dupsrm_sorted_indexed.bam
samtools index /scratch/pf887/chipseq/NewChIPData/porfirio/2020-08-27_HGVGWAFX2/merged/BAM/BAMs_w_rvm_duplicates/chip_input_4_clean_dupsrm_sorted_indexed.bam

echo "indexing of index files completed successfully"

#--------------------------------------------------


Next, coverage generation see below “4_BAM_Coverage_everything.sh”

#!/bin/bash
#
#BATCH --verbose
#SBATCH --job-name=bamCoverage
#SBATCH --time=4:00:00
#SBATCH --nodes=1
#SBATCH --mem=60GB

##
## NOTE: This script is specific to the ChIP-seq pipeline
##

#Load in required tools
module purge
module load samtools/intel/1.6
module load deeptools/3.3.1
module load r/intel/3.4.2

#Time
start=$(date +"%T")
echo "Start coverage bams at: $start"


#deeptools/3.3.1
#8.      generate coverage file for input and chip:
#bamCoverage --bam chip or input.bam -o $chip or input_raw_coverage \
#--binSize 100 \
#--extendReads 200 \
#--outFileFormat bedgraph \
#--minMappingQuality 20 \ 
#--ignoreDuplicates \ 
#--normalizeUsing CPM \
#   	--exactScaling \
#   	-bl /scratch/cgsb/ercan/annot/ce10-blacklist.bed \
#--ignoreForNormalization chrM
#may not need ignore dups /qscore command command because we filtered them out. 

bamCoverage --bam /scratch/pf887/chipseq/NewChIPData/porfirio/2020-08-27_HGVGWAFX2/merged/BAM/BAMs_w_rvm_duplicates/chip_sample_2_clean_dupsrm_sorted_indexed.bam -o /scratch/pf887/chipseq/NewChIPData/porfirio/2020-08-27_HGVGWAFX2/merged/BAM/BAMs_w_rvm_duplicates/chip_sample_2_clean_dupsrm_sorted_indexed_raw_coverage \
--binSize 100 \
--extendReads 200 \
--outFileFormat bedgraph \
--minMappingQuality 20 \
--ignoreDuplicates \
--normalizeUsing CPM \
--exactScaling \
-bl /scratch/pf887/chipseq/NewChIPData/porfirio/2020-08-27_HGVGWAFX2/merged/blacklist/ce10-blacklist.bed \
--ignoreForNormalization chrM

bamCoverage --bam /scratch/pf887/chipseq/NewChIPData/porfirio/2020-08-27_HGVGWAFX2/merged/BAM/BAMs_w_rvm_duplicates/chip_sample_3_clean_dupsrm_sorted_indexed.bam -o /scratch/pf887/chipseq/NewChIPData/porfirio/2020-08-27_HGVGWAFX2/merged/BAM/BAMs_w_rvm_duplicates/chip_sample_3_clean_dupsrm_sorted_indexed_raw_coverage \
--binSize 100 \
--extendReads 200 \
--outFileFormat bedgraph \
--minMappingQuality 20 \
--ignoreDuplicates \
--normalizeUsing CPM \
--exactScaling \
-bl /scratch/pf887/chipseq/NewChIPData/porfirio/2020-08-27_HGVGWAFX2/merged/blacklist/ce10-blacklist.bed \
--ignoreForNormalization chrM

bamCoverage --bam /scratch/pf887/chipseq/NewChIPData/porfirio/2020-08-27_HGVGWAFX2/merged/BAM/BAMs_w_rvm_duplicates/chip_sample_4_clean_dupsrm_sorted_indexed.bam -o /scratch/pf887/chipseq/NewChIPData/porfirio/2020-08-27_HGVGWAFX2/merged/BAM/BAMs_w_rvm_duplicates/chip_sample_4_clean_dupsrm_sorted_indexed_raw_coverage \
--binSize 100 \
--extendReads 200 \
--outFileFormat bedgraph \
--minMappingQuality 20 \
--ignoreDuplicates \
--normalizeUsing CPM \
--exactScaling \
-bl /scratch/pf887/chipseq/NewChIPData/porfirio/2020-08-27_HGVGWAFX2/merged/blacklist/ce10-blacklist.bed \
--ignoreForNormalization chrM

bamCoverage --bam /scratch/pf887/chipseq/NewChIPData/porfirio/2020-08-27_HGVGWAFX2/merged/BAM/BAMs_w_rvm_duplicates/chip_input_2_clean_dupsrm_sorted_indexed.bam -o /scratch/pf887/chipseq/NewChIPData/porfirio/2020-08-27_HGVGWAFX2/merged/BAM/BAMs_w_rvm_duplicates/chip_input_2_clean_dupsrm_sorted_indexed_raw_coverage \
--binSize 100 \
--extendReads 200 \
--outFileFormat bedgraph \
--minMappingQuality 20 \
--ignoreDuplicates \
--normalizeUsing CPM \
--exactScaling \
-bl /scratch/pf887/chipseq/NewChIPData/porfirio/2020-08-27_HGVGWAFX2/merged/blacklist/ce10-blacklist.bed \
--ignoreForNormalization chrM

bamCoverage --bam /scratch/pf887/chipseq/NewChIPData/porfirio/2020-08-27_HGVGWAFX2/merged/BAM/BAMs_w_rvm_duplicates/chip_input_3_clean_dupsrm_sorted_indexed.bam -o /scratch/pf887/chipseq/NewChIPData/porfirio/2020-08-27_HGVGWAFX2/merged/BAM/BAMs_w_rvm_duplicates/chip_input_3_clean_dupsrm_sorted_indexed_raw_coverage \
--binSize 100 \
--extendReads 200 \
--outFileFormat bedgraph \
--minMappingQuality 20 \
--ignoreDuplicates \
--normalizeUsing CPM \
--exactScaling \
-bl /scratch/pf887/chipseq/NewChIPData/porfirio/2020-08-27_HGVGWAFX2/merged/blacklist/ce10-blacklist.bed \
--ignoreForNormalization chrM

bamCoverage --bam /scratch/pf887/chipseq/NewChIPData/porfirio/2020-08-27_HGVGWAFX2/merged/BAM/BAMs_w_rvm_duplicates/chip_input_4_clean_dupsrm_sorted_indexed.bam -o /scratch/pf887/chipseq/NewChIPData/porfirio/2020-08-27_HGVGWAFX2/merged/BAM/BAMs_w_rvm_duplicates/chip_input_4_clean_dupsrm_sorted_indexed_raw_coverage \
--binSize 100 \
--extendReads 200 \
--outFileFormat bedgraph \
--minMappingQuality 20 \
--ignoreDuplicates \
--normalizeUsing CPM \
--exactScaling \
-bl /scratch/pf887/chipseq/NewChIPData/porfirio/2020-08-27_HGVGWAFX2/merged/blacklist/ce10-blacklist.bed \
--ignoreForNormalization chrM

echo "Coverage Bam complete"

#-------------------------------------

